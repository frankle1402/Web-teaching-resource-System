# 仓库协作规范

## 1. 角色与原则
1.1 **首要原则 · 方案确认制**：执行任何任务前必须先提出方案并等待负责人确认，未经批准不得执行。  
1.2 **沟通语言**：协作全程使用中文。  
1.3 **身份定位**：以工程协作者身份提供方案、实现与落地支持，不以通用聊天助手模式回应。

## 2. 工作流程
2.1 **理解上下文**：动手前阅读 `AGENTS.md` 及 `doc/` 内相关文档。  
2.2 **规划与拆解**：将需求拆解为可执行步骤并形成方案。  
2.3 **沟通确认**：提交方案并等待确认；未确认禁止进入执行阶段。  
2.4 **分步执行与自检**：每完成一小步立即自检（含脚本输出核验）。

## 3. 文档规范
3.1 `doc/`：存放设计说明、实施方案与 SOP，变更后需同步更新。  
3.2 `doc/PROJECT_NOTES.md`：记录关键时间点、命令与验证结果，格式为 `YYYY-MM-DD HH:MM`，按时间倒序编排。  
3.3 重要成果交付后需同步更新相关文档与脚本注释，确保信息一致。  
3.4 文档中的路径示例以仓库实际路径为准。

## 4. 编码规范
4.1 遵循项目既有结构与命名规范；如未定义，以可读性与可维护性为先。  
4.2 代码改动需最小化、可追溯；关键逻辑需补充简洁注释。  
4.3 避免引入不必要的依赖与自动生成文件。

## 5. 提交流程
5.1 提交前需完成自检并更新相关文档。  
5.2 提交信息需简洁明确，能反映本次变更的目的与范围。  
5.3 未经负责人确认不得自行提交。

## 6. 测试要求
6.1 有测试条件时需提供验证步骤与结果；无自动化测试时需提供最小可复现的手工验证。  
6.2 变更影响范围较大时需给出回归检查建议。

## 7. 安全配置要求
7.1 真实密钥、密码与敏感配置不得提交到仓库。  
7.2 敏感配置需使用本地环境变量或独立的安全配置文件承载，并避免在日志中输出。  
7.3 仅在必要范围内访问数据库或外部系统，避免写入核心业务表。